<ion-view hide-nav-bar="true"  hide-back-button="true" view-title="{{'global.menu.indexpage' | translate}}">
    <ion-content>
            <div class="main-title">Sélection du module</div>
            <div class="return"><button ng-click="vm.goBack()" class="btn btn--red btn--return">Retour</div>
                <!--<div class="row text-center">
                    <div>
                        <h1>Choix du devis</h1>
                        <h3>MADERA</h3>
                    </div>
                </div>-->
                <jhi-alert-error></jhi-alert-error>
                <div class="row">
                        <div class="col col-50">
                            Filtrer par nature : 
                            <select 
                                class="form-control input--form"
                                ng-model="vm.nature"
                                    ng-options="nature as nature.nature for nature in vm.natures">
                                    <option label="Pas de nature" value="">Pas de nature</option>
                            </select>
                        </div>

                        <div class="col col-50">
                            <input type="text" class="input--text input--search" ng-model="vm.searchBox" />
                        </div>
                    </div>

               <div class="row">
                        <div class="col col-50">
                            <div class="table-responsive">
                                 <table class="index-table">
                                    <thead>
                                        <tr jh-sort="vm.predicate" ascending="vm.reverse" callback="vm.transition()">
                                            <th jh-sort-by="name"><span>Nom</span> <span class="glyphicon glyphicon-sort"></span></th>
                                          
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="module in vm.modules track by module.id" ng-show="(vm.nature == null || module.module_nature.id == vm.nature.id) && module.name.indexOf(vm.searchBox) > -1" >
                                            
                                            <td ng-click="vm.selectModule(module)" ng-class="{'assortment--crt': module == vm.currentModule}">{{module.name}}</td>
                                            
                                        </tr>
                                    </tbody>
                                </table>
                                </div>
                    </div>
                     <div class="col col-50">
                            <div class="table-responsive">
                             <table class="index-table">
                                <thead>
                                    <tr>
                                        <th><span>{{vm.currentModule.name}}</span> <span class="glyphicon glyphicon-sort"></span></th>
                                    </tr>
                                </thead>
                                 <tbody>
                                <tr>
                                <td>      
                                    Nature du module : {{vm.currentModule.module_nature.nature}}<br/>
                                    Coupe de principe : {{vm.currentModule.principal_cross_section.name}}<img class="assortment--img" src="{{CLOUNDINARY_URL}}{{vm.principal_cross_section.url}}" /><br/>
                                    Prix : {{vm.currentModule.price}} €<br/>
                                    Composants : <br/>


                                    <div class="table-responsive">
                                         <table class="index-table">
                                            <thead>
                                                <tr>
                                                    <th>Référence</th>
                                                    <th>Quantité</th>
                                                    <th>Image</th>
                                                </tr>
                                            </thead>
                                             <tbody>
                                            <tr ng-repeat="mc in vm.components track by mc.id">
                                                <td>{{mc.component.reference}}</td>
                                                <td>{{mc.quantity}}</td>
                                                <td><img src="{{CLOUNDINARY_URL}}{{mc.component.url}}" /></td>
                                            </tr>
                                            </tbody>
                                            </table>
                                            </div>



                                    

                                </td>
                                </tr>
                                </tbody>
                                </table>
                                </div>
                                
                     </div>
                </div>

                <div class="row">
                        <div class="col col-50 col-offset-50">
                            <button class="btn btn--default" ng-click="vm.validModule()">Valider</button>
                        </div>
                    </div>


    </ion-content>
</ion-view>

